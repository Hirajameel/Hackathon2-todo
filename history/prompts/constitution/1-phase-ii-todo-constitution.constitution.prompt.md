---
id: 1
title: "phase-ii-todo-constitution"
stage: "constitution"
date_iso: "2026-02-07"
surface: "agent"
model: "claude-sonnet-4-5-20250929"
feature: "none"
branch: "master"
user: "DELL"
command: "/sp.constitution"
labels: ["constitution", "spec", "todo-app"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files_yaml:
  - ".specify/memory/constitution.md"
tests_yaml: []
---

# Prompt History Record

## Command
`/sp.constitution`

## Prompt Text
```
You are acting as a Spec-Kit Plus Product Constitution Generator.

Project Name: Hackathon Todo – Phase II (Full-Stack Web Application)

Goal:
Generate a strict, enforceable Spec Constitution for Phase II of the Todo project.
This constitution will govern how all agents (Claude Code, sub-agents, and skills)
are allowed to design, implement, and modify the system.

Context:
Phase I (In-Memory Python Console App) is complete.
Phase II evolves the system into a secure, multi-user, full-stack web application
using a spec-driven, agentic development workflow.

High-Level Architecture:
- Frontend: Next.js 16+ (App Router)
- Backend: Python FastAPI
- ORM: SQLModel
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth (Frontend) + JWT verification (Backend)
- Repository Type: Monorepo with Spec-Kit structure

Core Principles to Enforce:
1. Spec-Driven Development Only
   - No implementation without an approved spec
   - Specs are the single source of truth
   - If behavior is unclear, update the spec before coding

2. No Manual Coding
   - All code must be generated by Claude Code via specs
   - Human role is Product Architect and Reviewer only

3. Separation of Concerns
   - Frontend, backend, database, and auth must be clearly separated
   - Frontend must never directly access the database
   - Backend must never trust frontend user identity without JWT verification

4. Authentication & Security
   - All API endpoints must require a valid JWT
   - JWT must be verified using a shared secret (BETTER_AUTH_SECRET)
   - User identity must be extracted from JWT, not from request body
   - Task ownership must be enforced at the backend level

5. User Isolation
   - A user can only see, create, update, or delete their own tasks
   - Any mismatch between JWT user_id and route user_id must result in 403 Forbidden

6. API Consistency
   - RESTful conventions must be followed
   - All endpoints must live under /api/
   - Responses must be JSON
   - Errors must use proper HTTP status codes

7. Database Integrity
   - All task records must be associated with a user_id
   - Database schema changes require spec updates
   - ORM (SQLModel) must be used for all DB access

8. Frontend Discipline
   - All API calls must go through a centralized API client
   - JWT token must be automatically attached to every request
   - No direct fetch calls inside UI components

9. Monorepo Discipline
   - Specs live in /specs with Spec-Kit conventions
   - Root CLAUDE.md defines global rules
   - Sub CLAUDE.md files define frontend and backend constraints
   - Agents must respect folder boundaries

10. Evaluation Readiness
   - The system must be demonstrable end-to-end
   - Authentication, authorization, and data isolation must be provable
   - The evolution from Phase I to Phase II must be clear

Output Requirements:
- Title: Phase II – Todo Full-Stack Spec Constitution
- Clearly numbered, non-ambiguous rules
- Written in authoritative, policy-style language
- This constitution must override all other instructions unless explicitly updated

Do NOT generate implementation code.
Only generate the Spec Constitution document.
```

## Response Text
Created the Phase II – Todo Full-Stack Spec Constitution document with all 10 core principles as specified, plus additional constraints, development workflow, and governance sections. The constitution now serves as the authoritative guide for the project's development, enforcing spec-driven development, security requirements, and architectural constraints.