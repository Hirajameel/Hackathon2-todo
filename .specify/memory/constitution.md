<!-- Sync Impact Report
Version change: N/A (new file) → 1.0.0
Added sections: All principles and governance sections
Templates requiring updates: N/A
Follow-up TODOs: None
-->
# Phase II – Todo Full-Stack Spec Constitution

## Core Principles

### Spec-Driven Development Only
All development must be driven by approved specifications. No implementation work shall proceed without a corresponding, approved spec. Specifications serve as the single source of truth for all system behavior. When system behavior is unclear or undefined, the specification must be updated before any coding activity commences.

### No Manual Coding
All code must be generated by Claude Code via specifications. Human contributors are restricted to roles of Product Architect and Specification Reviewer only. No direct manual code modifications are permitted. All changes must flow through specification updates followed by code generation.

### Separation of Concerns
The frontend, backend, database, and authentication layers must be clearly separated. The frontend must never directly access the database. The backend must never trust frontend user identity without proper JWT verification. Each layer must maintain its distinct responsibilities and boundaries.

### Authentication & Security
All API endpoints must require a valid JWT for access. JWTs must be verified using a shared secret (BETTER_AUTH_SECRET). User identity must be extracted from JWT claims, never from request bodies or headers provided by clients. Task ownership must be enforced at the backend level through proper authentication and authorization checks.

### User Isolation
A user may only see, create, update, or delete their own tasks. Any mismatch between the JWT user_id and route user_id must result in a 403 Forbidden response. No user may access, modify, or view another user's data without explicit authorization.

### API Consistency
All API endpoints must follow RESTful conventions. All endpoints must be located under the /api/ path. All responses must be in JSON format. All errors must use proper HTTP status codes according to RFC 7231 standards.

### Database Integrity
All task records must be associated with a user_id to ensure proper ownership. Database schema changes must be reflected in specifications before implementation. All database access must utilize the SQLModel ORM for consistency and safety.

### Frontend Discipline
All API calls must route through a centralized API client to ensure consistent authentication handling. JWT tokens must be automatically attached to every request without manual intervention in individual components. Direct fetch calls inside UI components are prohibited.

### Monorepo Discipline
Specifications must be stored in the /specs directory following Spec-Kit conventions. The root CLAUDE.md file defines global rules and constraints. Sub CLAUDE.md files define frontend and backend specific constraints. All agents must respect established folder boundaries and project structure.

### Evaluation Readiness
The system must be demonstrable in a complete end-to-end fashion. Authentication, authorization, and data isolation capabilities must be provable through testing. The evolution from Phase I (Console App) to Phase II (Full-Stack Web Application) must be clearly documented and evident in the implemented solution.

## Additional Constraints

### Technology Stack Requirements
- Frontend: Next.js 16+ (App Router)
- Backend: Python FastAPI
- ORM: SQLModel
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth (Frontend) + JWT verification (Backend)
- Repository Type: Monorepo with Spec-Kit structure

### Security Requirements
- All API endpoints must validate JWT tokens
- User identity extraction must occur from JWT payload only
- Backend must never trust client-provided user identifiers
- Proper HTTP status codes must be returned for all authentication/authorization failures

## Development Workflow

### Specification Review Process
- All features must begin with a properly formatted specification
- Specifications must include acceptance criteria and test scenarios
- Multi-user isolation must be clearly addressed in all relevant specs
- Authentication and authorization requirements must be explicitly defined

### Quality Gates
- All code must pass through Claude Code generation process
- Specifications must be validated for clarity and completeness
- Security considerations must be addressed before implementation
- Multi-user data isolation must be verified during testing

## Governance

This constitution establishes the governing principles for the Hackathon Todo – Phase II (Full-Stack Web Application) project. All development activities, code generation, and system modifications must comply with these principles. This document supersedes all previous instructions and serves as the ultimate authority for acceptable development practices.

Changes to this constitution require explicit approval and must follow semantic versioning:
- MAJOR: Backward incompatible governance or principle removal/redefinition
- MINOR: New principle addition or material expansion of guidance
- PATCH: Clarifications, wording fixes, non-semantic refinements

All amendments must be documented with clear rationales and impact assessments before implementation.

**Version**: 1.0.0 | **Ratified**: 2026-02-07 | **Last Amended**: 2026-02-07
